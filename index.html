
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>티커별 차트</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        .chart-container { margin-bottom: 30px; }
        .btn-group { margin-top: 0px; display: flex; justify-content: center; }
        button { margin: 2px; }
    </style>
</head>
<body>
<div class="chart-container">
        <div id="chart-^GSPC"></div>
        <div class="btn-group">
            <button onclick="updateChart('^GSPC', '3m')">3m</button>
            <button onclick="updateChart('^GSPC', '6m')">6m</button>
            <button onclick="updateChart('^GSPC', '1y')">1y</button>
            <button onclick="updateChart('^GSPC', '5y')">5y</button>
            <button onclick="updateChart('^GSPC', 'all')">all</button>
        </div>
    </div><div class="chart-container">
        <div id="chart-^N225"></div>
        <div class="btn-group">
            <button onclick="updateChart('^N225', '3m')">3m</button>
            <button onclick="updateChart('^N225', '6m')">6m</button>
            <button onclick="updateChart('^N225', '1y')">1y</button>
            <button onclick="updateChart('^N225', '5y')">5y</button>
            <button onclick="updateChart('^N225', 'all')">all</button>
        </div>
    </div><div class="chart-container">
        <div id="chart-GC=F"></div>
        <div class="btn-group">
            <button onclick="updateChart('GC=F', '3m')">3m</button>
            <button onclick="updateChart('GC=F', '6m')">6m</button>
            <button onclick="updateChart('GC=F', '1y')">1y</button>
            <button onclick="updateChart('GC=F', '5y')">5y</button>
            <button onclick="updateChart('GC=F', 'all')">all</button>
        </div>
    </div><div class="chart-container">
        <div id="chart-BTC-USD"></div>
        <div class="btn-group">
            <button onclick="updateChart('BTC-USD', '3m')">3m</button>
            <button onclick="updateChart('BTC-USD', '6m')">6m</button>
            <button onclick="updateChart('BTC-USD', '1y')">1y</button>
            <button onclick="updateChart('BTC-USD', '5y')">5y</button>
            <button onclick="updateChart('BTC-USD', 'all')">all</button>
        </div>
    </div>
<script>
var tickerData = {};
tickerData['^GSPC'] = {dates: [...], prices: [...], colors: [...]};
tickerData['^N225'] = {dates: [...], prices: [...], colors: [...]};
tickerData['GC=F'] = {dates: [...], prices: [...], colors: [...]};
tickerData['BTC-USD'] = {dates: [...], prices: [...], colors: [...]};


function getPeriodDates(dates, period) {
    var end = new Date(dates[dates.length-1]);
    var start;
    if (period === '3m') {
        start = new Date(end); start.setMonth(end.getMonth()-3);
    } else if (period === '6m') {
        start = new Date(end); start.setMonth(end.getMonth()-6);
    } else if (period === '1y') {
        start = new Date(end); start.setFullYear(end.getFullYear()-1);
    } else if (period === '5y') {
        start = new Date(end); start.setFullYear(end.getFullYear()-5);
    } else {
        start = new Date(dates[0]);
    }
    return dates.filter(function(d) {
        var dt = new Date(d);
        return dt >= start && dt <= end;
    });
}

function updateChart(ticker, period) {
    var data = tickerData[ticker];
    var dates = data.dates;
    var prices = data.prices;
    var colors = data.colors;
    var periodDates = getPeriodDates(dates, period);
    var idxStart = dates.indexOf(periodDates[0]);
    var idxEnd = dates.indexOf(periodDates[periodDates.length-1]);
    var showDates = dates.slice(idxStart, idxEnd+1);
    var showPrices = prices.slice(idxStart, idxEnd+1);
    var showColors = colors.slice(idxStart, idxEnd+1);
    var trace = {
        x: showDates,
        y: showPrices,
        mode: 'lines',
        line: {color: 'black'},
        marker: {color: showColors},
        name: ''
    };
    Plotly.react('chart-'+ticker, [trace], {title: '', width:300, height:200});
}

window.onload = function() {
    for (var ticker in tickerData) {
        updateChart(ticker, '5y');
    }
}
</script>
</body></html>